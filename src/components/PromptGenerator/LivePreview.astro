---
// Live Preview Component - Updated with Glassmorphic Design
---

<div class="relative">
  <!-- Preview Card with Glassmorphic Design -->
  <div class="relative rounded-3xl p-6 sm:p-8 bg-white/70 dark:bg-zinc-900/70 transition-all duration-300 group"
       style="box-shadow: 0 0 60px -15px rgba(127, 115, 255, 0.15), 0 25px 80px -25px rgba(20, 208, 240, 0.10), 0 8px 32px -8px rgba(0, 0, 0, 0.1);">
    
    <!-- Subtle gradient overlay -->
    <div class="absolute inset-0 bg-gradient-to-br from-candy-purple/5 via-transparent to-candy-teal/5 pointer-events-none rounded-3xl"></div>
    
    <!-- Content -->
    <div class="relative">
      
      <!-- Header -->
      <div class="flex items-center justify-between mb-6">
        <h2 class="text-xl font-bold flex items-center gap-3" style="color: var(--text-primary);">
          <div class="w-10 h-10 rounded-xl flex items-center justify-center
                      bg-candy-teal/20 
                      text-[color:color-mix(in_srgb,var(--candy-teal),black_40%)] dark:text-[color:color-mix(in_srgb,var(--candy-teal),white_40%)]"
               style="box-shadow: 0 0 25px -5px var(--candy-teal), 0 8px 25px -10px var(--candy-teal);">
            <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
              <path d="M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z"/>
              <polyline points="14 2 14 8 20 8"/>
            </svg>
          </div>
          Pratinjau
        </h2>
        <span id="char-count" class="text-sm font-medium px-3 py-1.5 rounded-full
                                      bg-candy-blue/10 text-candy-blue
                                      border border-candy-blue/20">
          0 karakter
        </span>
      </div>

      <!-- Quality Indicator -->
      <div class="relative mb-6 p-5 rounded-2xl transition-all duration-300
                  bg-white/50 dark:bg-zinc-800/50
                  border border-zinc-200/50 dark:border-zinc-700/50">
        <div class="flex items-center justify-between mb-3">
          <span class="text-sm font-semibold" style="color: var(--text-secondary);">Kualitas Prompt</span>
          <span id="quality-score" class="text-2xl font-bold" data-score="0" style="color: #ef4444;">0%</span>
        </div>
        
        <!-- Progress Bar -->
        <div class="relative h-3 bg-zinc-200/50 dark:bg-zinc-700/50 rounded-full overflow-hidden mb-3">
          <div id="quality-bar" 
               class="h-full rounded-full transition-all duration-500 ease-out"
               style="width: 0%; background: linear-gradient(90deg, #ef4444, #dc2626);"></div>
        </div>
        
        <!-- Suggestion -->
        <p id="quality-suggestion" class="text-xs" style="color: var(--text-secondary);">
          Mulai isi form untuk membuat prompt...
        </p>
      </div>

      <!-- Preview Content -->
      <div class="relative rounded-2xl p-6 min-h-[400px] transition-all duration-300
                  bg-zinc-50/80 dark:bg-zinc-800/50
                  border border-zinc-200/50 dark:border-zinc-700/50">
        <pre id="prompt-preview" 
             class="whitespace-pre-wrap font-mono text-sm leading-relaxed" 
             style="color: var(--text-primary);">
<span style="color: var(--text-secondary);" class="italic">Isi form di samping untuk membuat prompt...</span></pre>
      </div>

      <!-- Action Buttons -->
      <div class="mt-6 flex gap-3">
        <!-- Reset Button -->
        <button 
          id="reset-btn"
          type="button"
          class="flex-shrink-0 px-4 py-4 rounded-2xl font-semibold
                 bg-zinc-100 dark:bg-zinc-800 
                 text-zinc-700 dark:text-zinc-300
                 hover:bg-zinc-200 dark:hover:bg-zinc-700
                 active:scale-95
                 transition-all duration-300
                 border border-zinc-300 dark:border-zinc-600">
          <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <path d="M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8"/>
            <path d="M21 3v5h-5"/>
            <path d="M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16"/>
            <path d="M3 21v-5h5"/>
          </svg>
        </button>

        <!-- Copy Button -->
        <button 
          id="copy-btn"
          disabled
          class="flex-1 relative overflow-hidden
                 px-6 py-4 rounded-2xl font-semibold text-white
                 bg-candy-purple
                 hover:scale-[1.02] active:scale-[0.98]
                 disabled:opacity-50 disabled:cursor-not-allowed disabled:hover:scale-100
                 transition-all duration-300 group/btn
                 shadow-lg hover:shadow-xl"
          style="box-shadow: 0 0 40px -10px var(--candy-purple), 0 20px 40px -20px var(--candy-purple);">
          <!-- Shimmer effect -->
          <div class="absolute inset-0 -translate-x-full group-hover/btn:translate-x-full transition-transform duration-1000 bg-gradient-to-r from-transparent via-white/20 to-transparent"></div>
          
          <span class="relative flex items-center justify-center gap-2">
            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
              <rect width="14" height="14" x="8" y="8" rx="2" ry="2"/>
              <path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"/>
            </svg>
            <span id="copy-text">Salin Prompt</span>
          </span>
        </button>
      </div>

    </div>
  </div>
</div>

<!-- Copy Toast Notification -->
<div id="copy-toast" 
     class="fixed bottom-8 right-8 px-6 py-4 rounded-2xl
            bg-gradient-to-r from-candy-purple to-candy-lime text-white font-semibold
            shadow-2xl transform translate-y-32 opacity-0 transition-all duration-300 z-50"
     style="box-shadow: 0 0 60px -10px var(--candy-purple);">
  <div class="flex items-center gap-3">
    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round">
      <polyline points="20 6 9 17 4 12"/>
    </svg>
    <span>Prompt berhasil disalin!</span>
  </div>
</div>

<!-- Reset Toast Notification -->
<div id="reset-toast" 
     class="fixed bottom-8 right-8 px-6 py-4 rounded-2xl
            bg-gradient-to-r from-candy-teal to-candy-blue text-white font-semibold
            shadow-2xl transform translate-y-32 opacity-0 transition-all duration-300 z-50"
     style="box-shadow: 0 0 60px -10px var(--candy-teal);">
  <div class="flex items-center gap-3">
    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round">
      <path d="M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8"/>
      <path d="M21 3v5h-5"/>
      <path d="M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16"/>
      <path d="M3 21v-5h5"/>
    </svg>
    <span>Form berhasil direset!</span>
  </div>
</div>

<style is:global>
  /* Highlight animation for changed text - Smooth fade in/out */
  .highlight-change {
    animation: highlight-glow 1.5s ease-in-out;
    border-radius: 4px;
    padding: 2px 4px;
    margin: -2px -4px;
    display: inline;
  }
  
  @keyframes highlight-glow {
    0% {
      background-color: transparent;
      box-shadow: none;
    }
    15% {
      background-color: rgba(127, 115, 255, 0.3);
      box-shadow: 0 0 8px rgba(127, 115, 255, 0.4);
    }
    30% {
      background-color: rgba(127, 115, 255, 0.25);
      box-shadow: 0 0 12px rgba(127, 115, 255, 0.35);
    }
    50% {
      background-color: rgba(127, 115, 255, 0.2);
      box-shadow: 0 0 8px rgba(127, 115, 255, 0.25);
    }
    75% {
      background-color: rgba(127, 115, 255, 0.1);
      box-shadow: 0 0 4px rgba(127, 115, 255, 0.15);
    }
    100% {
      background-color: transparent;
      box-shadow: none;
    }
  }
  
  /* Dark mode highlight */
  :global(.dark) .highlight-change {
    animation: highlight-glow-dark 1.5s ease-in-out;
  }
  
  @keyframes highlight-glow-dark {
    0% {
      background-color: transparent;
      box-shadow: none;
    }
    15% {
      background-color: rgba(127, 115, 255, 0.4);
      box-shadow: 0 0 10px rgba(127, 115, 255, 0.5);
    }
    30% {
      background-color: rgba(127, 115, 255, 0.35);
      box-shadow: 0 0 15px rgba(127, 115, 255, 0.45);
    }
    50% {
      background-color: rgba(127, 115, 255, 0.25);
      box-shadow: 0 0 10px rgba(127, 115, 255, 0.3);
    }
    75% {
      background-color: rgba(127, 115, 255, 0.12);
      box-shadow: 0 0 5px rgba(127, 115, 255, 0.15);
    }
    100% {
      background-color: transparent;
      box-shadow: none;
    }
  }
  
  /* Toast animation */
  #copy-toast.show,
  #reset-toast.show {
    transform: translateY(0);
    opacity: 1;
  }
  
  /* Preview text styling */
  #prompt-preview strong {
    font-weight: 700;
    color: var(--candy-purple);
  }
  
  #prompt-preview em {
    font-style: italic;
    opacity: 0.6;
  }
</style>
